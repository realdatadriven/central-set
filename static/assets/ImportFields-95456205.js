import{S as ot,i as ct,s as ut,z as ne,I as ze,e as g,c as Le,a as N,t as B,w as it,b as c,a6 as Ve,B as Me,d as te,f as a,m as je,C as Pe,l as ve,G as Be,n as X,h as Ae,j as oe,k as Fe,g as ee,o as le,p as Ee,D as _t,q as Je,_ as pt,r as mt,u as ht,F as Qe,L as gt,T as bt,W as dt,V as kt,a9 as wt,N as vt,$ as Ot,v as he,x as Ne,A as ge,a0 as Ct,a1 as Ue}from"./index-8239faad.js";import"./pt-4424e41e.js";import{P as rt}from"./Pagination-0cc50f26.js";function Ke(l,n,t){const e=l.slice();return e[45]=n[t],e[41]=t,e}function Xe(l,n,t){const e=l.slice();return e[47]=n[t],e[49]=t,e}function Ye(l,n,t){const e=l.slice();return e[47]=n[t],e}function Ze(l,n,t){const e=l.slice();return e[39]=n[t],e[40]=n,e[41]=t,e}function ye(l,n,t){const e=l.slice();return e[42]=n[t],e}function Lt(l){var J,R,p;let n,t,e,i,s,o,_,E,r,I,P=he(Object.keys(((J=l[10])==null?void 0:J[0])||[])),j=[];for(let m=0;m<P.length;m+=1)j[m]=$e(Ye(l,P,m));let S=he(l[10].slice(l[5]*l[4],l[5]*l[4]+l[4])),w=[];for(let m=0;m<S.length;m+=1)w[m]=et(Ke(l,S,m));return r=new rt({props:{lang:(R=l[13])==null?void 0:R.lang,conf:(p=l[13])==null?void 0:p.conf,rows_per_page:l[4],page:l[5],total_rows:l[10].length}}),r.$on("pageChange",l[34]),{c(){n=g("div"),t=g("div"),e=g("table"),i=g("thead"),s=g("tr");for(let m=0;m<j.length;m+=1)j[m].c();o=N(),_=g("tbody");for(let m=0;m<w.length;m+=1)w[m].c();E=N(),Le(r.$$.fragment),c(e,"class","table table-zebra w-full normal-case table-xs"),c(t,"class","overflow-x-auto"),c(n,"class","w-full")},m(m,k){te(m,n,k),a(n,t),a(t,e),a(e,i),a(i,s);for(let O=0;O<j.length;O+=1)j[O]&&j[O].m(s,null);a(e,o),a(e,_);for(let O=0;O<w.length;O+=1)w[O]&&w[O].m(_,null);a(n,E),je(r,n,null),I=!0},p(m,k){var u,d,T;if(k[0]&1024){P=he(Object.keys(((u=m[10])==null?void 0:u[0])||[]));let v;for(v=0;v<P.length;v+=1){const W=Ye(m,P,v);j[v]?j[v].p(W,k):(j[v]=$e(W),j[v].c(),j[v].m(s,null))}for(;v<j.length;v+=1)j[v].d(1);j.length=P.length}if(k[0]&1072){S=he(m[10].slice(m[5]*m[4],m[5]*m[4]+m[4]));let v;for(v=0;v<S.length;v+=1){const W=Ke(m,S,v);w[v]?w[v].p(W,k):(w[v]=et(W),w[v].c(),w[v].m(_,null))}for(;v<w.length;v+=1)w[v].d(1);w.length=S.length}const O={};k[0]&8192&&(O.lang=(d=m[13])==null?void 0:d.lang),k[0]&8192&&(O.conf=(T=m[13])==null?void 0:T.conf),k[0]&16&&(O.rows_per_page=m[4]),k[0]&32&&(O.page=m[5]),k[0]&1024&&(O.total_rows=m[10].length),r.$set(O)},i(m){I||(ee(r.$$.fragment,m),I=!0)},o(m){oe(r.$$.fragment,m),I=!1},d(m){m&&le(n),Ne(j,m),Ne(w,m),Ee(r)}}}function jt(l){var ke,we;let n,t,e,i,s,o,_=l[14].t("crud.db")+"",E,r,I=l[14].t("crud.field")+"",P,j,S,w=l[14].t("crud.field")+"",J,R,p=l[14].t("crud.label")+"",m,k,O,u=l[14].t("crud.match")+"",d,T,v=l[14].t("crud.file")+"",W,se,fe=ne(l[2])+"",Y,ae,be,$=l[14].t("crud.deactivate")+"",me,ce,ue,de,ie,M,Z=he(Object.keys(l[8]||{}).slice(l[7]*l[6],l[7]*l[6]+l[6])),z=[];for(let f=0;f<Z.length;f+=1)z[f]=st(Ze(l,Z,f));return ie=new rt({props:{lang:(ke=l[13])==null?void 0:ke.lang,conf:(we=l[13])==null?void 0:we.conf,rows_per_page:l[6],page:l[7],total_rows:Object.keys(l[8]||{}).length}}),ie.$on("pageChange",l[33]),{c(){n=g("div"),t=g("div"),e=g("table"),i=g("thead"),s=g("tr"),o=g("th"),E=B(_),r=N(),P=B(I),j=N(),S=g("th"),J=B(w),R=N(),m=B(p),k=N(),O=g("th"),d=B(u),T=N(),W=B(v),se=B(" - "),Y=B(fe),ae=N(),be=g("th"),me=B($),ce=N(),ue=g("tbody");for(let f=0;f<z.length;f+=1)z[f].c();de=N(),Le(ie.$$.fragment),c(o,"class","normal-case"),c(S,"class","normal-case"),c(O,"class","normal-case"),c(be,"class","normal-case"),c(e,"class","table table-zebra w-full normal-case table-xs"),c(t,"class","overflow-x-auto"),c(n,"class","w-full")},m(f,b){te(f,n,b),a(n,t),a(t,e),a(e,i),a(i,s),a(s,o),a(o,E),a(o,r),a(o,P),a(s,j),a(s,S),a(S,J),a(S,R),a(S,m),a(s,k),a(s,O),a(O,d),a(O,T),a(O,W),a(O,se),a(O,Y),a(s,ae),a(s,be),a(be,me),a(e,ce),a(e,ue);for(let C=0;C<z.length;C+=1)z[C]&&z[C].m(ue,null);a(n,de),je(ie,n,null),M=!0},p(f,b){var G,y;if((!M||b[0]&16384)&&_!==(_=f[14].t("crud.db")+"")&&X(E,_),(!M||b[0]&16384)&&I!==(I=f[14].t("crud.field")+"")&&X(P,I),(!M||b[0]&16384)&&w!==(w=f[14].t("crud.field")+"")&&X(J,w),(!M||b[0]&16384)&&p!==(p=f[14].t("crud.label")+"")&&X(m,p),(!M||b[0]&16384)&&u!==(u=f[14].t("crud.match")+"")&&X(d,u),(!M||b[0]&16384)&&v!==(v=f[14].t("crud.file")+"")&&X(W,v),(!M||b[0]&4)&&fe!==(fe=ne(f[2])+"")&&X(Y,fe),(!M||b[0]&16384)&&$!==($=f[14].t("crud.deactivate")+"")&&X(me,$),b[0]&960){Z=he(Object.keys(f[8]||{}).slice(f[7]*f[6],f[7]*f[6]+f[6]));let A;for(A=0;A<Z.length;A+=1){const _e=Ze(f,Z,A);z[A]?z[A].p(_e,b):(z[A]=st(_e),z[A].c(),z[A].m(ue,null))}for(;A<z.length;A+=1)z[A].d(1);z.length=Z.length}const C={};b[0]&8192&&(C.lang=(G=f[13])==null?void 0:G.lang),b[0]&8192&&(C.conf=(y=f[13])==null?void 0:y.conf),b[0]&64&&(C.rows_per_page=f[6]),b[0]&128&&(C.page=f[7]),b[0]&256&&(C.total_rows=Object.keys(f[8]||{}).length),ie.$set(C)},i(f){M||(ee(ie.$$.fragment,f),M=!0)},o(f){oe(ie.$$.fragment,f),M=!1},d(f){f&&le(n),Ne(z,f),Ee(ie)}}}function $e(l){let n,t=ne(l[47],30)+"",e,i,s;return{c(){n=g("th"),e=B(t),i=N(),c(n,"class","normal-case"),c(n,"title",s=ge(l[47],30))},m(o,_){te(o,n,_),a(n,e),a(n,i)},p(o,_){_[0]&1024&&t!==(t=ne(o[47],30)+"")&&X(e,t),_[0]&1024&&s!==(s=ge(o[47],30))&&c(n,"title",s)},d(o){o&&le(n)}}}function Et(l){let n,t=ne(l[45][l[47]],30)+"",e,i;return{c(){n=g("td"),e=B(t),c(n,"title",i=ge(l[45][l[47]],30))},m(s,o){te(s,n,o),a(n,e)},p(s,o){o[0]&1072&&t!==(t=ne(s[45][s[47]],30)+"")&&X(e,t),o[0]&1072&&i!==(i=ge(s[45][s[47]],30))&&c(n,"title",i)},d(s){s&&le(n)}}}function Rt(l){let n,t=ne(l[45][l[47]],30)+"",e,i;return{c(){n=g("th"),e=B(t),c(n,"title",i=ge(l[45][l[47]],30))},m(s,o){te(s,n,o),a(n,e)},p(s,o){o[0]&1072&&t!==(t=ne(s[45][s[47]],30)+"")&&X(e,t),o[0]&1072&&i!==(i=ge(s[45][s[47]],30))&&c(n,"title",i)},d(s){s&&le(n)}}}function xe(l){let n;function t(s,o){return s[49]===0?Rt:Et}let i=t(l)(l);return{c(){i.c(),n=it()},m(s,o){i.m(s,o),te(s,n,o)},p(s,o){i.p(s,o)},d(s){s&&le(n),i.d(s)}}}function et(l){var s;let n,t,e=he(Object.keys(((s=l[10])==null?void 0:s[0])||[])),i=[];for(let o=0;o<e.length;o+=1)i[o]=xe(Xe(l,e,o));return{c(){n=g("tr");for(let o=0;o<i.length;o+=1)i[o].c();t=N(),c(n,"class","hover")},m(o,_){te(o,n,_);for(let E=0;E<i.length;E+=1)i[E]&&i[E].m(n,null);a(n,t)},p(o,_){var E;if(_[0]&1072){e=he(Object.keys(((E=o[10])==null?void 0:E[0])||[]));let r;for(r=0;r<e.length;r+=1){const I=Xe(o,e,r);i[r]?i[r].p(I,_):(i[r]=xe(I),i[r].c(),i[r].m(n,t))}for(;r<i.length;r+=1)i[r].d(1);i.length=e.length}},d(o){o&&le(n),Ne(i,o)}}}function tt(l){let n,t,e,i=he(l[9]||[]),s=[];for(let _=0;_<i.length;_+=1)s[_]=lt(ye(l,i,_));function o(){l[31].call(n,l[39])}return{c(){n=g("select");for(let _=0;_<s.length;_+=1)s[_].c();c(n,"class","select select-sm p-0.5 w-full bg-transparent"),l[8][l[39]].file_field_match===void 0&&Ct(o)},m(_,E){te(_,n,E);for(let r=0;r<s.length;r+=1)s[r]&&s[r].m(n,null);Ue(n,l[8][l[39]].file_field_match,!0),t||(e=ve(n,"change",o),t=!0)},p(_,E){if(l=_,E[0]&512){i=he(l[9]||[]);let r;for(r=0;r<i.length;r+=1){const I=ye(l,i,r);s[r]?s[r].p(I,E):(s[r]=lt(I),s[r].c(),s[r].m(n,null))}for(;r<s.length;r+=1)s[r].d(1);s.length=i.length}E[0]&960&&Ue(n,l[8][l[39]].file_field_match)},d(_){_&&le(n),Ne(s,_),t=!1,e()}}}function lt(l){let n,t=l[42]+"",e,i;return{c(){n=g("option"),e=B(t),n.__value=i=l[42],Pe(n,n.__value)},m(s,o){te(s,n,o),a(n,e)},p(s,o){o[0]&512&&t!==(t=s[42]+"")&&X(e,t),o[0]&512&&i!==(i=s[42])&&(n.__value=i,Pe(n,n.__value))},d(s){s&&le(n)}}}function nt(l){let n,t,e;function i(){l[32].call(n,l[39])}return{c(){n=g("input"),c(n,"type","checkbox"),c(n,"class","checkbox checkbox-sm")},m(s,o){te(s,n,o),n.checked=l[8][l[39]].deactivate,t||(e=ve(n,"change",i),t=!0)},p(s,o){l=s,o[0]&960&&(n.checked=l[8][l[39]].deactivate)},d(s){s&&le(n),t=!1,e()}}}function st(l){var m,k,O,u;let n,t,e=ne(l[39],30)+"",i,s,o,_,E=ne((k=(m=l[8])==null?void 0:m[l[39]])==null?void 0:k.comment,30)+"",r,I,P,j,S,w,J,R=((O=l[8])==null?void 0:O[l[39]])&&tt(l),p=((u=l[8])==null?void 0:u[l[39]])&&nt(l);return{c(){var d,T;n=g("tr"),t=g("th"),i=B(e),o=N(),_=g("td"),r=B(E),P=N(),j=g("td"),R&&R.c(),S=N(),w=g("td"),p&&p.c(),J=N(),c(t,"title",s=ge(l[39],30)),c(_,"title",I=ge((T=(d=l[8])==null?void 0:d[l[39]])==null?void 0:T.comment,30)),c(j,"class","p-0"),c(w,"class","p-0 text-center"),c(n,"class","hover")},m(d,T){te(d,n,T),a(n,t),a(t,i),a(n,o),a(n,_),a(_,r),a(n,P),a(n,j),R&&R.m(j,null),a(n,S),a(n,w),p&&p.m(w,null),a(n,J)},p(d,T){var v,W,se,fe,Y,ae;T[0]&448&&e!==(e=ne(d[39],30)+"")&&X(i,e),T[0]&960&&s!==(s=ge(d[39],30))&&c(t,"title",s),T[0]&448&&E!==(E=ne((W=(v=d[8])==null?void 0:v[d[39]])==null?void 0:W.comment,30)+"")&&X(r,E),T[0]&960&&I!==(I=ge((fe=(se=d[8])==null?void 0:se[d[39]])==null?void 0:fe.comment,30))&&c(_,"title",I),(Y=d[8])!=null&&Y[d[39]]?R?R.p(d,T):(R=tt(d),R.c(),R.m(j,null)):R&&(R.d(1),R=null),(ae=d[8])!=null&&ae[d[39]]?p?p.p(d,T):(p=nt(d),p.c(),p.m(w,null)):p&&(p.d(1),p=null)},d(d){d&&le(n),R&&R.d(),p&&p.d()}}}function ft(l){let n,t;return n=new gt({props:{open:l[12]}}),{c(){Le(n.$$.fragment)},m(e,i){je(n,e,i),t=!0},p(e,i){const s={};i[0]&4096&&(s.open=e[12]),n.$set(s)},i(e){t||(ee(n.$$.fragment,e),t=!0)},o(e){oe(n.$$.fragment,e),t=!1},d(e){Ee(n,e)}}}function at(l){let n,t;return n=new bt({props:{open:l[11].open,type:l[11].type,msg:l[11].msg,timer:2e4}}),n.$on("dismiss",l[35]),{c(){Le(n.$$.fragment)},m(e,i){je(n,e,i),t=!0},p(e,i){const s={};i[0]&2048&&(s.open=e[11].open),i[0]&2048&&(s.type=e[11].type),i[0]&2048&&(s.msg=e[11].msg),n.$set(s)},i(e){t||(ee(n.$$.fragment,e),t=!0)},o(e){oe(n.$$.fragment,e),t=!1},d(e){Ee(n,e)}}}function qt(l){let n,t,e,i,s,o,_,E,r,I,P,j,S,w,J,R,p,m,k,O,u,d,T,v=l[14].t("crud.save_as_tmp")+"",W,se,fe,Y,ae,be,$,me,ce,ue,de,ie,M,Z,z,ke,we=ne(l[14].t("crud.match"),30)+"",f,b,C,G,y,A=l[14].t("crud.preview")+"",_e,pe,L=l[14].t("crud.file")+"",F,x,H,Ce,re,Q,V,Se,qe,Ie,D,Te,He;s=new ze({props:{type:"outline",icon:"link",path:"icons"}}),R=new ze({props:{type:"outline",icon:"paper-clip",path:"icons"}}),ce=new ze({props:{type:"outline",icon:"refresh",path:"icons"}});const We=[jt,Lt],Oe=[];function De(h,q){var Re;return h[1]===0?0:h[1]===1&&((Re=h[10])==null?void 0:Re.length)>0?1:-1}~(Q=De(l))&&(V=Oe[Q]=We[Q](l));let U=l[12]&&ft(l),K=l[11].open&&at(l);return{c(){var h;n=g("div"),t=g("div"),e=g("a"),i=g("span"),Le(s.$$.fragment),E=N(),r=g("input"),S=N(),w=g("button"),J=g("span"),Le(R.$$.fragment),m=N(),k=g("div"),O=g("label"),u=g("input"),T=g("span"),W=B(v),fe=N(),Y=g("input"),be=N(),$=g("button"),me=g("span"),Le(ce.$$.fragment),ie=N(),M=g("div"),Z=g("div"),z=g("span"),ke=g("b"),f=B(we),C=N(),G=g("span"),y=g("b"),_e=B(A),pe=N(),F=B(L),H=N(),Ce=g("span"),Ce.innerHTML="<b></b>",re=N(),V&&V.c(),Se=N(),U&&U.c(),qe=N(),K&&K.c(),Ie=it(),c(i,"class","w-5 h-5"),c(e,"class","btn btn-square btn-ghost btn-sm -mr-8 z-[1]"),c(e,"title",o=l[14].t("crud.download")),c(e,"target","_blank"),c(e,"href",_=`${Ve((h=l[13])==null?void 0:h.conf,!0)}/${l[2]}`),Me(e,"display",l[2]?null:"none"),c(r,"type","text"),c(r,"id",I=`${l[0]}-file-to-import`),c(r,"placeholder",P=l[14].t("crud.file")),c(r,"class",j="grow input "+(l[2]?"pl-8":"")+" pr-8 input-bordered w-full input-sm"),c(r,"autocomplete","off"),c(r,"autocorrect","off"),c(J,"class","w-5 h-5"),c(w,"class","btn btn-square btn-ghost btn-sm -ml-8 z-[1]"),c(w,"title",p=`${l[14].t("crud.attach")} ${l[14].t("crud.file")}`),c(u,"type","checkbox"),c(u,"class","checkbox checkbox-sm mr-2"),c(u,"id",d=l[0]+"-tmp"),c(T,"class","label-text"),c(O,"class","label cursor-pointer justify-start"),c(O,"for",se=l[0]+"-tmp"),c(k,"class","form-control w-auto p-0 ml-2"),c(Y,"type","file"),c(Y,"id",ae=`${l[0]}-file-to-import-file`),Me(Y,"display","none"),c(me,"class","w-5 h-5"),c($,"class","btn btn-square btn-sm ml-2"),c($,"title",ue=`${l[14].t("crud.refresh")}`),$.disabled=de=!l[2],c(t,"class","flex mb-2 mt-2"),c(ke,"class","pr-2"),c(z,"class",b="tab tab-lifted text-md "+(l[1]===0?"tab-active active":"")),c(y,"class","pr-2"),c(G,"class",x="tab tab-lifted text-md "+(l[1]===1?"tab-active active":"")),c(Ce,"class","tab tab-lifted text-md grow"),c(Z,"class","tabs w-full"),c(M,"class","grow w-full"),c(n,"class","flex flex-col")},m(h,q){te(h,n,q),a(n,t),a(t,e),a(e,i),je(s,i,null),a(t,E),a(t,r),Pe(r,l[2]),a(t,S),a(t,w),a(w,J),je(R,J,null),a(t,m),a(t,k),a(k,O),a(O,u),u.checked=l[3],a(O,T),a(T,W),a(t,fe),a(t,Y),a(t,be),a(t,$),a($,me),je(ce,me,null),a(n,ie),a(n,M),a(M,Z),a(Z,z),a(z,ke),a(ke,f),a(Z,C),a(Z,G),a(G,y),a(y,_e),a(y,pe),a(y,F),a(Z,H),a(Z,Ce),a(M,re),~Q&&Oe[Q].m(M,null),te(h,Se,q),U&&U.m(h,q),te(h,qe,q),K&&K.m(h,q),te(h,Ie,q),D=!0,Te||(He=[ve(r,"input",l[24]),ve(w,"click",l[25]),ve(u,"change",l[26]),ve(Y,"change",l[27]),ve($,"click",l[28]),ve(z,"click",Be(l[29])),ve(G,"click",Be(l[30]))],Te=!0)},p(h,q){var Ge;(!D||q[0]&16384&&o!==(o=h[14].t("crud.download")))&&c(e,"title",o),(!D||q[0]&8196&&_!==(_=`${Ve((Ge=h[13])==null?void 0:Ge.conf,!0)}/${h[2]}`))&&c(e,"href",_),q[0]&4&&Me(e,"display",h[2]?null:"none"),(!D||q[0]&1&&I!==(I=`${h[0]}-file-to-import`))&&c(r,"id",I),(!D||q[0]&16384&&P!==(P=h[14].t("crud.file")))&&c(r,"placeholder",P),(!D||q[0]&4&&j!==(j="grow input "+(h[2]?"pl-8":"")+" pr-8 input-bordered w-full input-sm"))&&c(r,"class",j),q[0]&4&&r.value!==h[2]&&Pe(r,h[2]),(!D||q[0]&16384&&p!==(p=`${h[14].t("crud.attach")} ${h[14].t("crud.file")}`))&&c(w,"title",p),(!D||q[0]&1&&d!==(d=h[0]+"-tmp"))&&c(u,"id",d),q[0]&8&&(u.checked=h[3]),(!D||q[0]&16384)&&v!==(v=h[14].t("crud.save_as_tmp")+"")&&X(W,v),(!D||q[0]&1&&se!==(se=h[0]+"-tmp"))&&c(O,"for",se),(!D||q[0]&1&&ae!==(ae=`${h[0]}-file-to-import-file`))&&c(Y,"id",ae),(!D||q[0]&16384&&ue!==(ue=`${h[14].t("crud.refresh")}`))&&c($,"title",ue),(!D||q[0]&4&&de!==(de=!h[2]))&&($.disabled=de),(!D||q[0]&16384)&&we!==(we=ne(h[14].t("crud.match"),30)+"")&&X(f,we),(!D||q[0]&2&&b!==(b="tab tab-lifted text-md "+(h[1]===0?"tab-active active":"")))&&c(z,"class",b),(!D||q[0]&16384)&&A!==(A=h[14].t("crud.preview")+"")&&X(_e,A),(!D||q[0]&16384)&&L!==(L=h[14].t("crud.file")+"")&&X(F,L),(!D||q[0]&2&&x!==(x="tab tab-lifted text-md "+(h[1]===1?"tab-active active":"")))&&c(G,"class",x);let Re=Q;Q=De(h),Q===Re?~Q&&Oe[Q].p(h,q):(V&&(Ae(),oe(Oe[Re],1,1,()=>{Oe[Re]=null}),Fe()),~Q?(V=Oe[Q],V?V.p(h,q):(V=Oe[Q]=We[Q](h),V.c()),ee(V,1),V.m(M,null)):V=null),h[12]?U?(U.p(h,q),q[0]&4096&&ee(U,1)):(U=ft(h),U.c(),ee(U,1),U.m(qe.parentNode,qe)):U&&(Ae(),oe(U,1,1,()=>{U=null}),Fe()),h[11].open?K?(K.p(h,q),q[0]&2048&&ee(K,1)):(K=at(h),K.c(),ee(K,1),K.m(Ie.parentNode,Ie)):K&&(Ae(),oe(K,1,1,()=>{K=null}),Fe())},i(h){D||(ee(s.$$.fragment,h),ee(R.$$.fragment,h),ee(ce.$$.fragment,h),ee(V),ee(U),ee(K),D=!0)},o(h){oe(s.$$.fragment,h),oe(R.$$.fragment,h),oe(ce.$$.fragment,h),oe(V),oe(U),oe(K),D=!1},d(h){h&&(le(n),le(Se),le(qe),le(Ie)),Ee(s),Ee(R),Ee(ce),~Q&&Oe[Q].d(),U&&U.d(h),K&&K.d(h),Te=!1,_t(He)}}}function It(l,n,t){let e,i;Je(l,pt,f=>t(13,e=f)),Je(l,mt,f=>t(14,i=f));let{table:s}=n,{main_table:o}=n,{action:_={}}=n,{data:E={}}=n,{option:r={}}=n,I=0,P,j=!0,S=10,w=0,J=10,R=0,p={},m=[],k=[],O={},u={open:!1,msg:null,type:null},d=!1;const T=async f=>{t(12,d=!0);const b={lang:e==null?void 0:e.lang,conf:e==null?void 0:e.conf,token:e==null?void 0:e.token,app:e==null?void 0:e.selected_app,table:(f==null?void 0:f.table)||s,data:(f==null?void 0:f.data)||k};if(!b.data||!b.table)return t(12,d=!1),null;const C=await dt(b);C.success===!0?(t(11,u.open=!0,u),t(11,u.type="success",u),t(11,u.msg=C.msg,u),C!=null&&C.inserted_primary_key,await ae({table:s,main_table:o,data:E}),await W({file:P,tmp:j})):(t(11,u.open=!0,u),t(11,u.type="error",u),t(11,u.msg=C.msg,u)),t(12,d=!1)},v=f=>{try{document.getElementById(f.id).click()}catch(b){console.log(b.message)}},W=async f=>{var b;if(f.file){t(12,d=!0);const C={lang:e==null?void 0:e.lang,conf:e==null?void 0:e.conf,token:e==null?void 0:e.token,app:e==null?void 0:e.selected_app,_method:"dump_file_2_object",data:f},G=await kt(C);if(G.success===!0&&G.data){t(10,k=G.data),t(1,I=1);for(let L=0;L<k.length;L++)t(10,k[L]={...k[L],...E,order:L+1,field_order:L+1},k);t(9,m=Object.keys(k[0])),m.forEach(L=>{var F,x,H,Ce;if(p!=null&&p[L])t(8,p[L].file_field_match=L,p);else for(const re in p){const Q=new RegExp(re.replace("sql_","").replace("field_",""),"i");if(Object.hasOwnProperty.call(p,re)&&(((F=p[re])==null?void 0:F.comment.toLowerCase())===L.toLowerCase()||((x=p[re])==null?void 0:x.field.toLowerCase())===L.toLowerCase()||L.match(Q))&&t(8,p[re].file_field_match=L,p),r!=null&&r.data){if((H=r==null?void 0:r.data)!=null&&H[re]&&!p[re].file_field_match){for(let V=0;V<m.length;V++)if(((Ce=r==null?void 0:r.data)==null?void 0:Ce[re].indexOf(m[V].toLowerCase()))!==-1){t(8,p[re].file_field_match=m[V],p);break}}}}});let y=((b=r==null?void 0:r.data)==null?void 0:b.key)||"field_name";k.map(L=>{var x;for(const H in p)Object.hasOwnProperty.call(p,H)&&p[H].file_field_match&&(L[H]=L[p[H].file_field_match]);let F=O.filter(H=>H[y]===L[y]);for(const H in(F==null?void 0:F[0])||{})Object.hasOwnProperty.call(F==null?void 0:F[0],H)&&(p!=null&&p[H])&&!H.match(/sql|SQL|SELECT|WHERE|FROM|GROUP|ORDER|HAVING|JOIN|WINDOW/i)&&(L[H]||(L[H]=(x=F==null?void 0:F[0])==null?void 0:x[H]),p[H].file_field_match||t(8,p[H].file_field_match=H,p));return L});const A=k.map(L=>L==null?void 0:L[y]),_e=k.map(L=>{var F,x;return L==null?void 0:L[(x=(F=e==null?void 0:e.tables)==null?void 0:F[s])==null?void 0:x.pk]});let pe=O.filter(L=>{var F,x;return A.indexOf(L[y])===-1||_e.indexOf(L[(x=(F=e==null?void 0:e.tables)==null?void 0:F[s])==null?void 0:x.pk])===-1});pe=pe.map(L=>({...L,excluded:!0,table:s})),t(10,k=[...k,...pe])}else t(11,u.open=!0,u),t(11,u.type="error",u),t(11,u.msg=G.msg,u);t(12,d=!1)}},se=async f=>{t(12,d=!0);try{t(2,P=f.event.currentTarget.files[0].name);const b={lang:e==null?void 0:e.lang,conf:e==null?void 0:e.conf,token:e==null?void 0:e.token,file:f.event.currentTarget.files[0],tmp:j,path:null},C=await wt(b);C.success===!0?(t(2,P=C.file),t(11,u.open=!0,u),t(11,u.type="success",u),t(11,u.msg=C.msg,u),await W({file:P,tmp:j})):(t(11,u.open=!0,u),t(11,u.type="error",u),t(11,u.msg=C.msg,u))}catch(b){console.log(b.message),t(11,u.open=!0,u),t(11,u.type="error",u),t(11,u.msg=b.message,u)}t(12,d=!1)},fe=f=>{f.type==="next"?t(5,w+=1):f.type==="back"?t(5,w-=1):f.type==="first"?t(5,w=0):f.type==="last"?t(5,w=Math.ceil(S/((k==null?void 0:k.length)||S))):f.type==="rows_per_page"&&(t(4,S=f.rows_per_page),t(5,w=0))},Y=f=>{f.type==="next"?t(7,R+=1):f.type==="back"?t(7,R-=1):f.type==="first"?t(7,R=0):f.type==="last"?t(7,R=Math.ceil(J/((k==null?void 0:k.length)||S))):f.type==="rows_per_page"&&(t(6,J=f.rows_per_page),t(7,R=0))},ae=async f=>{var G;f.no_loding||t(12,d=!0);const b={lang:e==null?void 0:e.lang,conf:e==null?void 0:e.conf,token:e==null?void 0:e.token,app:e==null?void 0:e.selected_app,table:s,filters:[{field:"etl_rbase_output_id",cond:"=",value:(G=f==null?void 0:f.data)==null?void 0:G.etl_rbase_output_id}],limit:-1},C=await vt(b);console.log("_data_uploaded:",b,C),C.success===!0&&C.data?O=C.data:(t(11,u.open=!0,u),t(11,u.type="error",u),t(11,u.msg=C.msg,u)),t(12,d=!1)};ht(()=>{var f,b,C,G,y,A,_e;i.changeLanguage(e==null?void 0:e.lang),console.log(s,o,r,E,(f=e==null?void 0:e.tables)==null?void 0:f[s]);try{Qe.locale(e==null?void 0:e.lang)}catch{Qe.locale("en-us")}for(let pe in((C=(b=e==null?void 0:e.tables)==null?void 0:b[s])==null?void 0:C.fields)||{})t(8,p[pe]={field:pe,comment:(_e=(A=(y=(G=e==null?void 0:e.tables)==null?void 0:G[s])==null?void 0:y.fields)==null?void 0:A[pe])==null?void 0:_e.comment,file_field_match:null},p);ae({table:s,main_table:o,data:E})});function be(){P=this.value,t(2,P)}const $=f=>v({id:`${s}-file-to-import-file`});function me(){j=this.checked,t(3,j)}const ce=f=>se({event:f}),ue=f=>W({file:P,tmp:j}),de=()=>{t(1,I=0)},ie=()=>{t(1,I=1)};function M(f){p[f].file_field_match=Ot(this),t(8,p),t(9,m)}function Z(f){p[f].deactivate=this.checked,t(8,p),t(9,m)}const z=f=>Y(f.detail),ke=f=>fe(f.detail),we=f=>{t(11,u.open=!1,u)};return l.$$set=f=>{"table"in f&&t(0,s=f.table),"main_table"in f&&t(20,o=f.main_table),"action"in f&&t(21,_=f.action),"data"in f&&t(22,E=f.data),"option"in f&&t(23,r=f.option)},l.$$.update=()=>{var f,b,C;l.$$.dirty[0]&1&&console.log({table:s}),l.$$.dirty[0]&2097152&&(((f=_==null?void 0:_.name)==null?void 0:f.toLowerCase())=="CANCEL".toLowerCase()&&(_==null||_.action()),((b=_==null?void 0:_.name)==null?void 0:b.toLowerCase())=="REFRESH".toLowerCase()&&console.log(_),((C=_==null?void 0:_.name)==null?void 0:C.toLowerCase())=="SAVE".toLowerCase()&&(console.log(_),T(null)))},[s,I,P,j,S,w,J,R,p,m,k,u,d,e,i,v,W,se,fe,Y,o,_,E,r,be,$,me,ce,ue,de,ie,M,Z,z,ke,we]}class Tt extends ot{constructor(n){super(),ct(this,n,It,qt,ut,{table:0,main_table:20,action:21,data:22,option:23},null,[-1,-1])}}export{Tt as default};
